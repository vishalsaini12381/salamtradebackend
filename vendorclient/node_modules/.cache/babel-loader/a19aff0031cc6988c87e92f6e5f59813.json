{"ast":null,"code":"import { getValue, setValue, merge, isBlazor } from './util';\nimport { Base } from './base';\n/**\n * To detect the changes for inner properties.\n * @private\n */\n\nvar ChildProperty =\n/** @class */\nfunction () {\n  function ChildProperty(parent, propName, defaultValue, isArray) {\n    this.properties = {};\n    this.changedProperties = {};\n    this.childChangedProperties = {};\n    this.oldProperties = {}; // tslint:disable-next-line:no-empty\n\n    this.finalUpdate = function () {};\n\n    this.callChildDataBind = getValue('callChildDataBind', Base);\n    this.parentObj = parent;\n    this.controlParent = this.parentObj.controlParent || this.parentObj;\n    this.propName = propName;\n    this.setProperties(defaultValue, true);\n    this.isParentArray = isArray;\n  }\n  /**\n   * Updates the property changes\n   * @param {boolean} val\n   * @param {string} propName\n   * @returns {void}\n   */\n\n\n  ChildProperty.prototype.updateChange = function (val, propName) {\n    if (val === true) {\n      this.parentObj.childChangedProperties[propName] = val;\n    } else {\n      delete this.parentObj.childChangedProperties[propName];\n    }\n\n    if (this.parentObj.updateChange) {\n      this.parentObj.updateChange(val, this.parentObj.propName);\n    }\n  };\n  /**\n   * Updates time out duration\n   */\n\n\n  ChildProperty.prototype.updateTimeOut = function () {\n    if (this.parentObj.updateTimeOut) {\n      this.parentObj.finalUpdate();\n      this.parentObj.updateTimeOut();\n    } else {\n      var changeTime_1 = setTimeout(this.parentObj.dataBind.bind(this.parentObj));\n\n      var clearUpdate = function () {\n        clearTimeout(changeTime_1);\n      };\n\n      this.finalUpdate = clearUpdate;\n    }\n  };\n  /**\n   * Clears changed properties\n   */\n\n\n  ChildProperty.prototype.clearChanges = function () {\n    this.finalUpdate();\n    this.updateChange(false, this.propName);\n    this.oldProperties = {};\n    this.changedProperties = {};\n  };\n  /**\n   * Set property changes\n   * @param {Object} prop\n   * @param {boolean} muteOnChange\n   * {void}\n   */\n\n\n  ChildProperty.prototype.setProperties = function (prop, muteOnChange) {\n    if (muteOnChange === true) {\n      merge(this, prop);\n      this.updateChange(false, this.propName);\n      this.clearChanges();\n    } else {\n      merge(this, prop);\n    }\n  };\n  /**\n   * Binds data\n   */\n\n\n  ChildProperty.prototype.dataBind = function () {\n    this.callChildDataBind(this.childChangedProperties, this);\n\n    if (this.isParentArray) {\n      var curIndex = this.parentObj[this.propName].indexOf(this);\n\n      if (Object.keys(this.changedProperties).length) {\n        setValue(this.propName + '.' + curIndex, this.changedProperties, this.parentObj.changedProperties);\n        setValue(this.propName + '.' + curIndex, this.oldProperties, this.parentObj.oldProperties);\n      }\n    } else {\n      this.parentObj.changedProperties[this.propName] = this.changedProperties;\n      this.parentObj.oldProperties[this.propName] = this.oldProperties;\n    }\n\n    this.clearChanges();\n  };\n  /**\n   * Saves changes to newer values\n   * @param {string} key\n   * @param {Object} newValue\n   * @param {Object} oldValue\n   * @returns {void}\n   */\n\n\n  ChildProperty.prototype.saveChanges = function (key, newValue, oldValue) {\n    if (this.controlParent.isRendered && isBlazor()) {\n      var ejsInterop = 'ejsInterop';\n\n      if (window && window[ejsInterop]) {\n        window[ejsInterop].childSaveChanges.call(this, key, newValue, oldValue);\n      }\n    }\n\n    if (this.controlParent.isProtectedOnChange) {\n      return;\n    }\n\n    this.oldProperties[key] = oldValue;\n    this.changedProperties[key] = newValue;\n    this.updateChange(true, this.propName);\n    this.finalUpdate();\n    this.updateTimeOut();\n  };\n\n  return ChildProperty;\n}();\n\nexport { ChildProperty };","map":null,"metadata":{},"sourceType":"module"}